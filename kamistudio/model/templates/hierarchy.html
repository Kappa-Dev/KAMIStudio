{% extends "base.html" %}

{% block home_button %}
  <a href="/home" type="button" class="btn btn-primary btn-md panel-button home-button">
    <span class="glyphicon glyphicon-home"></span> Home
  </a>
{% endblock %}
{% block panel_buttons %}
<a href="{{ hierarchy_id }}"><h1 id="hierarchy_name">{{ hierarchy_id }}</h1></a><a href="/model/{{ hierarchy_id }}/add_interaction" type="button" class="btn btn-primary btn-md panel-button add-interaction-button"><span class="glyphicon glyphicon-plus"></span> Add interaction</a>
{% endblock %}

{% block sidebar_items %}
<!--   <div class="side-bar-tools">
    <h3 id="browsing">Tools</h3>
  </div> -->
{% endblock %}

{% block tabs %}

<!--     <ul class="nav nav-tabs">
      <li class="nav-item">
        <a class="nav-link active" href="#">
          Action graph ({% if hierarchies[hierarchy_id].empty() %}empty{% else %}{{ hierarchies[hierarchy_id].action_graph.nodes()|length }} nodes {% endif %})
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Nuggets ({% if hierarchies[hierarchy_id].empty() %}0{% else %}{{ hierarchies[hierarchy_id].nuggets()|length }}{% endif %} nuggets)</a>
      </li>
    </ul> -->

    <!-- Nav tabs -->
    <ul class="nav nav-tabs" role="tablist">
      <li class="nav-item">
        <a class="nav-link active" data-toggle="tab" href="#action_graph" role="tab">Action graph ({% if hierarchies[hierarchy_id].empty() %}empty{% else %}{{ hierarchies[hierarchy_id].action_graph.nodes()|length }} nodes {% endif %})</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#nuggets" role="tab">Nuggets ({% if hierarchies[hierarchy_id].empty() %}0{% else %}{{ hierarchies[hierarchy_id].nuggets()|length }}{% endif %} nuggets)</a>
      </li>
    </ul>

    <!-- Tab panes -->
    <div class="tab-content">
      <div class="tab-pane active" id="action_graph" role="tabpanel">
        {% if hierarchies[hierarchy_id].empty() %}
          Action graph is empty
        {% else %}
          Genes: {{ hierarchies[hierarchy_id].genes()|length }}<br>
          Modifications: {{ hierarchies[hierarchy_id].modifications()|length }}<br>
          Bindings: {{ hierarchies[hierarchy_id].bindings()|length }}<br>
        
        <div id="mynetwork"></div>

        {% endif %}

      </div>
      <div class="tab-pane" id="nuggets" role="tabpanel">

        {% if hierarchies[hierarchy_id].empty() %}
            Model does not contain any nuggets
        {% else %}
            <div class="nuggets-view">
              <a type="button" class="btn btn-default btn-md panel-button nugget-list-view active"><span class="glyphicon glyphicon-list"></span> List view</a>
              <a type="button" class="btn btn-default btn-md panel-button nugget-table-view"><span class="glyphicon glyphicon-equalizer"></span> Table view</a>
            </div>
            <div class="table-responsive">
              <table class="table table-striped table-sm">
                <!-- <thead>
                  <tr>
                    <th>#</th>
                  <th>Header</th>
                  <th>Header</th>
                  <th>Header</th>
                  <th>Header</th>
                </tr>
              </thead> -->
                <tbody>
                  {% for nugget in hierarchies[hierarchy_id].nuggets() %}
                  <tr>
                    <td>{{ nugget }}</td>
                    <td class="nugget-desc">{{ nugget_desc[nugget] }}</td>
                    <td class="nugget-nav-buttons"><a type="button" class="btn btn-primary btn-md panel-button show-nugget-button"><span class="glyphicon glyphicon-search"></span> Show graph</a></td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>

<!--           <ul class="list-group models">
          {% for nugget in hierarchies[hierarchy_id].nuggets() %}
            <li class="list-group-item nugget-item" id="{{ nugget }}">
              {{ nugget }}
              <span class="nugget-desc"> {{ nugget_desc[nugget] }}</span><span class="nugget-nav-buttons"><a type="button" class="btn btn-primary btn-md panel-button show-nugget-button"><span class="glyphicon glyphicon-search"></span> Show graph</a></span>
          </li>
          {% endfor %}
          </ul> -->
        {% endif %}
      </div>
    </div>



{% endblock %}
{% if hierarchies[hierarchy_id].empty() %}
{% else %}
  {% block scripts %}

    {{ super() }}
    <script src="{{url_for('static', filename='js/vis.js')}}" type="text/javascript"></script>
    <script type="text/javascript">
      // create an array with nodes

      var nodes = new vis.DataSet([
          {% for node in action_graph_nodelist %}{id: {{ node[0] }}, label: '{{ node[1] }}' },{% endfor %}
      ]);

      // create an array with edges
      var edges = new vis.DataSet([
        {% for edge in action_graph_edgelist %}{from: {{ edge[0] }}, to: {{ edge[1] }} },{% endfor %}
      ]);

      // create a network
      var container = document.getElementById('mynetwork');
      var data = {
        nodes: nodes,
        edges: edges
      };
      var options = {};
      var network = new vis.Network(container, data, options);
    </script>
  {% endblock %}
{% endif %}